xoctPaellaPlayer={data:[],config:{paella_config_file:"",paella_player_folder:"",is_live_stream:!1,event_start:0,event_end:0,check_script_hls:""},status:"playing",init:function(a,b){this.data=a,this.config=b,!0===this.config.is_live_stream?this.hasWorkingStream().then(function(a){"true"===a?(xoctPaellaPlayer.loadPlayer(),xoctPaellaPlayer.checkStreamStatus()):(xoctPaellaPlayer.triggerOverlays(),xoctPaellaPlayer.checkAndLoadLive())}):this.loadPlayer(),window.addEventListener("message",function(a){let b=a.data;$("#srchat_iframe").attr("height",b+"px")},!1)},reloadPlayer:function(){paella.player.pause(),delete paella,xoctPaellaPlayer.reloadScript(xoctPaellaPlayer.config.paella_player_folder+"/javascript/paella_player.js"),xoctPaellaPlayer.reloadScript(xoctPaellaPlayer.config.paella_player_folder+"/javascript/base.js"),$("#playerContainer").empty();let a=setInterval(function(){"object"==typeof paella&&(xoctPaellaPlayer.loadPlayer(),paella.player.play(),clearInterval(a))},500)},reloadScript:function(a){let b=document.createElement("script");b.type="text/javascript",b.src=a+"?"+new Date().getTime(),document.getElementsByTagName("head")[0].appendChild(b)},loadPlayer:function(){$("#overlay_live_waiting").hide(),this.filterStreams().then(()=>{paella.load("playerContainer",{data:xoctPaellaPlayer.data,configUrl:xoctPaellaPlayer.config.paella_config_file})})},triggerOverlays:function(){let a=Math.round(new Date().getTime()/1e3);a<xoctPaellaPlayer.config.event_start?xoctPaellaPlayer.showOverlay("waiting"):a>xoctPaellaPlayer.config.event_end?xoctPaellaPlayer.showOverlay("over"):xoctPaellaPlayer.showOverlay("interrupted")},showOverlay:function(a){xoctPaellaPlayer.hideOverlays(),$("#overlay_live_"+a).show()},hideOverlays:function(){$("#overlay_live_waiting").hide(),$("#overlay_live_interrupted").hide(),$("#overlay_live_over").hide()},isStreamWorking:async function(a){return await $.get(xoctPaellaPlayer.config.check_script_hls+"?url="+a)},hasWorkingStream:async function(){var a=!1;for(const b of xoctPaellaPlayer.data.streams)!1===a&&(a=await xoctPaellaPlayer.isStreamWorking(b.sources.hls[0].src));return a},checkAndLoadLive:async function(){var a=setInterval(async function(){"true"===(await xoctPaellaPlayer.hasWorkingStream())?(xoctPaellaPlayer.hideOverlays(),xoctPaellaPlayer.loadPlayer(),clearInterval(a),xoctPaellaPlayer.checkStreamStatus()):console.log("no working stream found - try again in 5 seconds")},5e3)},checkStreamStatus:function(){let a=null,b=async function(){console.log("check stream status");var c=Math.round(new Date().getTime()/1e3);"true"===(await xoctPaellaPlayer.hasWorkingStream())?("playing"!==xoctPaellaPlayer.status&&xoctPaellaPlayer.reloadPlayer(),xoctPaellaPlayer.status="playing",xoctPaellaPlayer.hideOverlays(),clearInterval(a),a=setInterval(b,2e4)):(xoctPaellaPlayer.status=c<xoctPaellaPlayer.config.event_start?"waiting":c>=xoctPaellaPlayer.config.event_end?"over":"interrupted",xoctPaellaPlayer.hideOverlays(),xoctPaellaPlayer.showOverlay(xoctPaellaPlayer.status),paella.player.pause(),clearInterval(a),"over"===xoctPaellaPlayer.status?$("#playerContainer").empty():a=setInterval(b,2e3))};a=setInterval(b,2e4)},filterStreams:async function(){if(this.config.is_live_stream)for(const a in xoctPaellaPlayer.data.streams)xoctPaellaPlayer.data.streams.hasOwnProperty(a)&&"true"!==(await xoctPaellaPlayer.isStreamWorking(xoctPaellaPlayer.data.streams[a].sources.hls[0].src))&&xoctPaellaPlayer.data.streams.splice(a,1)}};