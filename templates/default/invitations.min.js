var xoctInvitation={selected_id:0,data_url:"",container:null,filter_container:null,filtering:!1,lng:[delete_group="Delete Group?",no_title="Please insert title",none_available="None available",invite_all="Invite All"],before_load:function(){},after_load:function(){},lngFromJson:function(a){this.lng=JSON.parse(a)},init:function(a,b,c,d,e){"undefined"!=typeof d&&(this.before_load=d),"undefined"!=typeof e&&(this.after_load=e),this.data_url=a,$(b).html("<ul id=\"xoct_invitations\" class=\"list-group\"></ul>"),$(c).html("<button id=\"xoct_invite_all\" class=\"btn btn-primary\">"+this.lng.invite_all+"</button><ul id=\"xoct_available\" class=\"list-group\"></ul>"),this.container_invited=$("#xoct_invitations"),this.container_available=$("#xoct_available"),this.filter_container=$("#xoct_participant_filter"),this.load();var f=this;$(document).on("click",".xoct_remove",function(){f.removeInvitation($(this).parent().data("invitation-id"))}),$(document).on("click",".xoct_invite",function(){f.addInvitation($(this).parent().data("invitation-id"))}),this.filter_container.keyup(function(){f.filter($(this).val()),f.filtering&&!$("#xoct_filter").length?f.filter_container.after("<span class=\"input-group-btn\"><button class=\"btn btn-default\" id=\"xoct_filter\" type=\"button\"><span class=\"glyphicon glyphicon-remove\"></span> </button></span>"):!f.filtering&&$("#xoct_filter").remove()}),$(document).on("click","#xoct_filter",function(){f.filter_container.val(""),f.filter(""),$(this).remove()}),$(document).on("click","#xoct_invite_all",function(){f.inviteAll()})},clear:function(){this.container_invited.empty(),this.container_available.empty()},load:function(){var a=this;this.before_load();var b=this.data_url;$.ajax({url:b,type:"GET",data:{cmd:"getAll"}}).done(function(b){for(var c in a.clear(),b.available)a.container_available.append("<li class=\"list-group-item xoct_participant_available\" data-invitation-id=\""+b.available[c].id+"\"><div style=\"margin-right:30px;\">"+b.available[c].name+"</div><button class=\"btn btn-primary xoct_invite pull-right\"><span class=\"glyphicon glyphicon-plus\"></span></button></li>");for(var c in b.invited)a.container_invited.append("<li class=\"list-group-item\" data-invitation-id=\""+b.invited[c].id+"\"><div style=\"margin-right:30px;\">"+b.invited[c].name+"</div><button class=\"btn btn-default xoct_remove pull-right\"><span class=\"glyphicon glyphicon-minus\"></span></button></li>");b.available&&0!=b.available.length||a.container_available.html("<li class=\"list-group-item\">"+a.lng.none_available+"</li>"),b.invited&&0!=b.invited.length||a.container_invited.html("<li class=\"list-group-item\">"+a.lng.none_available+"</li>"),a.after_load()})},addInvitation:function(a){var b=this.data_url,c=this;this.before_load(),$.ajax({url:b+"&cmd=create",type:"POST",data:{id:a}}).done(function(){c.load(),c.after_load()})},inviteAll:function(){var a=[];$("#xoct_available li:visible").each(function(){a.push($(this).attr("data-invitation-id"))});var b=this.data_url,c=this;this.before_load(),$.ajax({url:b+"&cmd=createMultiple",type:"POST",data:{ids:a}}).done(function(){c.load(),c.after_load()})},removeInvitation:function(a){var b=this.data_url,c=this;this.before_load(),$.ajax({url:b+"&cmd=delete",type:"POST",data:{id:a}}).done(function(){$("[data-invitation-id=\""+a+"\"]").remove(),c.load(),c.after_load()})},filter:function(a){this.filtering=""!=a,$(".xoct_participant_available:not(:contains(\""+a+"\"))").hide(),$(".xoct_participant_available:contains(\""+a+"\")").show()}};